From 5c8c119edc38537ab3498a7726e8f98f763b3f01 Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Wed, 9 Dec 2020 13:30:31 +0800
Subject: [PATCH] hwc2: Restore old brightness control

 * We don't really support it yet.

Change-Id: Ic83be8cbde460338e682a9051fddb728387f6889
---
 sdm/libs/hwc2/hwc_session.cpp | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/sdm/libs/hwc2/hwc_session.cpp b/sdm/libs/hwc2/hwc_session.cpp
index 2cd107b..bb387cc 100644
--- a/sdm/libs/hwc2/hwc_session.cpp
+++ b/sdm/libs/hwc2/hwc_session.cpp
@@ -3339,7 +3339,7 @@ int32_t HWCSession::GetDisplayCapabilities(hwc2_device_t *device, hwc2_display_t
   if (!outCapabilities) {
     *outNumCapabilities = 0;
     if (isBuiltin) {
-      *outNumCapabilities = 4;
+      *outNumCapabilities = 3;
     }
     return HWC2_ERROR_NONE;
   } else {
@@ -3352,7 +3352,6 @@ int32_t HWCSession::GetDisplayCapabilities(hwc2_device_t *device, hwc2_display_t
       if (has_doze_support) {
         outCapabilities[index++] = HWC2_DISPLAY_CAPABILITY_DOZE;
       }
-      outCapabilities[index++] = HWC2_DISPLAY_CAPABILITY_BRIGHTNESS;
       outCapabilities[index++] = UINT32(HwcDisplayCapability::PROTECTED_CONTENTS);
       *outNumCapabilities = index;
     }
@@ -3422,7 +3421,7 @@ int32_t HWCSession::GetDisplayBrightnessSupport(hwc2_device_t *device, hwc2_disp
     DLOGE("Expected valid hwc_display");
     return HWC2_ERROR_BAD_PARAMETER;
   }
-  *outSupport = (hwc_display->GetDisplayClass() == DISPLAY_CLASS_BUILTIN);
+  *outSupport = false;
   return HWC2_ERROR_NONE;
 }
 
-- 
2.28.0

